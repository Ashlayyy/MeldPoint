import{b as W,A as U}from"./github-CLxWdIIs.js";import{g as B,W as g,a9 as q,N as u,o as c,d as a,_ as j,a3 as J,cw as Q,a1 as X,X as K,c as y,a as o,t as s,u as d,w as i,ba as M,O as C,an as E,P as A,bu as Y,am as Z,aS as $,e as m,E as I,J as V,f as z,aR as ee,a0 as S,ae as H,ap as te,bz as se,b4 as ae,bv as le,cQ as oe}from"./index-5wn-0GR-.js";import{m as ne}from"./marked.esm-DKjyhwJX.js";import{p as re}from"./purify.es-CEVJ7K31.js";const ie={class:"markdown-renderer"},ce=["innerHTML"],de=B({__name:"MarkdownRenderer",props:{content:{}},setup(L){const r=L,f=g(""),x=async p=>{const _=p.replace(/\r\n/g,`
`).replace(/\n{2,}/g,"§PARAGRAPH§").replace(/\n/g,"<br>").replace(/§PARAGRAPH§/g,`

`),n=await ne(_||"",{breaks:!0,gfm:!0});return re.sanitize(n,{ALLOWED_TAGS:["p","br","strong","em","ul","ol","li","code","pre","blockquote","a","h1","h2","h3","h4","h5","h6","hr","img","table","thead","tbody","tr","th","td","del","input"],ALLOWED_ATTR:["href","src","class","target","type","checked","disabled"]})};return q(()=>r.content,async p=>{f.value=await x(p)},{immediate:!0}),(p,_)=>(c(),u("div",ie,[a("div",{innerHTML:f.value,class:"markdown-body"},null,8,ce)]))}}),P=j(de,[["__scopeId","data-v-d93082bf"]]),ue={class:"my-issues-admin"},me={class:"header-section mb-6"},_e={class:"text-h5 font-weight-medium mb-2"},ve={class:"text-subtitle-2 text-medium-emphasis"},pe={key:0,class:"no-issues"},fe={key:1},be={class:"d-flex align-center flex-wrap gap-2 mb-2"},he={class:"issue-number text-medium-emphasis"},ye={class:"title-section text-h6 mb-2"},ge={class:"body-text mb-4"},xe={class:"d-flex align-center justify-space-between text-caption text-medium-emphasis"},ke={class:"d-flex align-center gap-4"},Ie={key:0},we={class:"d-flex align-center gap-2"},Ce={class:"issue-number text-medium-emphasis"},Ve={class:"text-h6"},Te={class:"d-flex align-center flex-wrap gap-2 mb-4"},Ae={class:"text-caption text-medium-emphasis"},ze={class:"description mb-6"},Se={class:"text-subtitle-1 mb-2"},Me={key:0,class:"comments-section mb-6"},$e={class:"text-subtitle-1 mb-4"},Le={class:"d-flex align-start gap-3 mb-2"},De={class:"font-weight-medium mr-2"},Ne={class:"text-caption text-medium-emphasis"},Re={class:"pl-11"},Ee={class:"add-comment-section mt-6"},He={class:"text-subtitle-1 mb-4"},Pe={key:1,class:"d-flex align-center justify-end text-caption text-medium-emphasis mt-6"},Be=B({__name:"MyIssues",setup(L){const{t:r}=J(),f=Q(),x=g([]),p=g(!0),_=g(!1),n=g(null),b=g(""),T=g(!1),D=X(),k=async(l=null)=>{p.value=!0;try{const t=await W("all");if(x.value=t,l!==null){const v=x.value.find(e=>e.number===l);v&&(n.value=v,_.value=!0)}}catch(t){console.error("Failed to load issues:",t)}finally{p.value=!1}},N=l=>l?l.filter(t=>t.name.toLowerCase()!=="helpdesk"):[],R=l=>{if(!(!l||l.toLowerCase()==="ededed"))return"#"+l},w=l=>{if(!l)return r("myIssues.labels.na");try{const t=new Date(l);return isNaN(t.getTime())?"Invalid date":oe(t,"MMM d, yyyy HH:mm")}catch(t){return console.error("Error formatting date:",t),"Invalid date"}},G=(l,t)=>l?l.length<=t?l:l.substring(0,t)+"...":"",O=l=>{n.value=l,b.value="",T.value=!1,_.value=!0},F=async()=>{var l,t;if(!(!n.value||!b.value.trim())){T.value=!0;try{const v=`
Naam: ${(l=D.user)==null?void 0:l.Name}
Email: ${(t=D.user)==null?void 0:t.Email}
Bericht: ${b.value.trim()}
`;await U(n.value.number.toString(),v);const e=n.value.number;await k(e),b.value=""}catch(v){console.error("Failed to submit comment:",v)}finally{T.value=!1}}};return K(()=>{k(),f.on("issue:created",()=>{console.log("Socket event: issue:created"),k()}),f.on("issue:updated",()=>{console.log("Socket event: issue:updated"),k()}),f.on("issue:deleted",()=>{console.log("Socket event: issue:deleted"),k()}),f.on("comment:created",l=>{console.log(`Socket event: comment:created for issue #${l}`),k()})}),(l,t)=>{var v;return c(),u("div",ue,[a("div",me,[a("h1",_e,s(d(r)("myIssues.title")),1),a("p",ve,s(d(r)("myIssues.subtitle")),1)]),p.value?(c(),y(M,{key:0,elevation:"1",class:"loading-card rounded-lg"},{default:i(()=>[o($,{class:"d-flex justify-center align-center"},{default:i(()=>[o(Z,{indeterminate:""})]),_:1})]),_:1})):(c(),u(C,{key:1},[((v=x.value)==null?void 0:v.length)===0?(c(),u("div",pe,[o(E,{size:"64",color:"grey"},{default:i(()=>t[4]||(t[4]=[m("mdi-alert-circle-outline")])),_:1,__:[4]}),a("p",null,s(d(r)("myIssues.emptyState")),1)])):(c(),u("div",fe,[(c(!0),u(C,null,A(x.value,e=>(c(),y(M,{key:e.id,class:"issue-card mb-4",elevation:"1",rounded:"lg"},{default:i(()=>[o($,null,{default:i(()=>[a("div",be,[a("span",he,"#"+s(e.number),1),o(V,{size:"small",color:e.state==="open"?"error":"grey",class:"text-capitalize"},{default:i(()=>[m(s(d(r)(`myIssues.states.${e.state}`)),1)]),_:2},1032,["color"]),(c(!0),u(C,null,A(N(e.labels),h=>(c(),y(V,{key:h.name,size:"small",variant:"outlined",color:R(h.color),class:"text-capitalize"},{default:i(()=>[m(s(h.name),1)]),_:2},1032,["color"]))),128)),e.comments&&e.comments.length>0?(c(),y(V,{key:0,size:"x-small","prepend-icon":"mdi-comment-outline"},{default:i(()=>[m(s(e.comments.length),1)]),_:2},1024)):I("",!0)]),a("div",ye,s(e.title),1),a("p",ge,s(G(e.body,150)),1),a("div",xe,[a("div",ke,[a("span",null,s(d(r)("myIssues.labels.created"))+" "+s(e.created_at?w(e.created_at):d(r)("myIssues.labels.na")),1),e.closed_at?(c(),u("span",Ie,s(d(r)("myIssues.labels.closed"))+" "+s(w(e.closed_at)),1)):I("",!0)]),o(z,{variant:"text",density:"comfortable",color:"primary",onClick:h=>O(e),class:"text-none"},{default:i(()=>[m(s(d(r)("myIssues.buttons.viewDetails"))+" ",1),o(E,{right:"",size:"small"},{default:i(()=>t[5]||(t[5]=[m("mdi-chevron-right")])),_:1,__:[5]})]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]))],64)),o(Y,{modelValue:_.value,"onUpdate:modelValue":t[3]||(t[3]=e=>_.value=e),"max-width":"800",scrollable:""},{default:i(()=>[n.value?(c(),y(M,{key:0},{default:i(()=>[o(ee,{class:"d-flex justify-space-between align-center pa-4"},{default:i(()=>[a("div",we,[a("span",Ce,"#"+s(n.value.number),1),a("span",Ve,s(n.value.title),1)]),o(z,{icon:"mdi-close",variant:"text",onClick:t[0]||(t[0]=e=>_.value=!1)})]),_:1}),o(S),o($,{class:"pa-4"},{default:i(()=>[a("div",Te,[o(V,{size:"small",color:n.value.state==="open"?"error":"grey",class:"text-capitalize"},{default:i(()=>[m(s(d(r)(`myIssues.states.${n.value.state}`)),1)]),_:1},8,["color"]),(c(!0),u(C,null,A(N(n.value.labels),e=>(c(),y(V,{key:e.name,size:"small",variant:"outlined",color:R(e.color),class:"text-capitalize"},{default:i(()=>[m(s(e.name),1)]),_:2},1032,["color"]))),128)),o(H),a("span",Ae,s(d(r)("myIssues.labels.created"))+" "+s(n.value.created_at?w(n.value.created_at):d(r)("myIssues.labels.na")),1)]),a("div",ze,[a("h4",Se,s(d(r)("myIssues.details.description")),1),o(P,{content:n.value.body},null,8,["content"])]),n.value.comments&&n.value.comments.length>0?(c(),u("div",Me,[a("h4",$e,s(d(r)("myIssues.details.commentsTitle",{count:n.value.comments.length})),1),o(S,{class:"mb-4"}),(c(!0),u(C,null,A(n.value.comments,(e,h)=>(c(),u("div",{key:e.id||h,class:"comment mb-4"},[a("div",Le,[o(te,{size:"32"},{default:i(()=>[o(se,{src:e.user.avatar_url,alt:e.user.login},null,8,["src","alt"])]),_:2},1024),a("div",null,[a("span",De,s(e.user.login),1),a("span",Ne,s(w(e.created_at)),1)])]),a("div",Re,[o(P,{content:e.body},null,8,["content"])]),h<n.value.comments.length-1?(c(),y(S,{key:0,class:"mt-4"})):I("",!0)]))),128))])):I("",!0),a("div",Ee,[a("h4",He,s(d(r)("myIssues.details.addCommentTitle")),1),o(ae,{modelValue:b.value,"onUpdate:modelValue":t[1]||(t[1]=e=>b.value=e),label:d(r)("myIssues.details.commentPlaceholder"),variant:"outlined",rows:"3","auto-grow":"","hide-details":"auto",class:"mb-3"},null,8,["modelValue","label"]),o(z,{color:"primary",onClick:F,disabled:!b.value.trim(),loading:T.value,block:""},{default:i(()=>[m(s(d(r)("myIssues.buttons.submitComment")),1)]),_:1},8,["disabled","loading"])]),n.value.closed_at?(c(),u("div",Pe,s(d(r)("myIssues.labels.closed"))+" "+s(w(n.value.closed_at)),1)):I("",!0)]),_:1}),o(S),o(le,{class:"pa-4"},{default:i(()=>[o(H),o(z,{color:"primary",variant:"text",onClick:t[2]||(t[2]=e=>_.value=!1)},{default:i(()=>[m(s(d(r)("myIssues.buttons.close")),1)]),_:1})]),_:1})]),_:1})):I("",!0)]),_:1},8,["modelValue"])])}}}),We=j(Be,[["__scopeId","data-v-1fb395ac"]]);export{We as default};
