import{br as M,W as S,S as A,g as R,bs as H,X as F,N as e,d as r,e as T,E as C,u as h,t as p,O as v,P as f,o as s,al as P,$ as x,_ as I}from"./index-5wn-0GR-.js";import{p as L}from"./purify.es-CEVJ7K31.js";import{a as O}from"./changelog-D5hDTksK.js";const w=M("changelog",()=>{const u=S([]),i=S(""),l=S(!1),a=S(null);return{changelogs:u,isLoading:l,error:a,source:i,fetchChangelogs:async()=>{l.value=!0,a.value=null,i.value="",u.value=[];try{const c=await O();u.value=c.changelogs,i.value=c.source}catch(c){console.error("Error in fetchChangelogs action:",c),c instanceof Error?a.value=c.message:a.value="An unknown error occurred while fetching changelogs.",u.value=[],i.value=""}finally{l.value=!1}}}}),z=(u,i)=>{const l=_=>_.replace(/^v/,"").split(".").map(Number),a=l(u),g=l(i),c=Math.max(a.length,g.length);for(let _=0;_<c;_++){const k=a[_]||0,m=g[_]||0;if(k>m)return 1;if(k<m)return-1}return 0};function B(u){return{currentVersion:A(()=>{const l=u.value.length>0?u.value[0]:null,a=l?l.version:"0.0.0",g="1.1.0";return z(g,a)>=0?g:a})}}const G={class:"changelog-page"},j={key:0,class:"source-chip"},X={key:1,class:"current-version-display"},W={key:0,class:"loading-message"},D={key:1,class:"error-message"},$={key:2},q={key:0,class:"upcoming-releases"},J={key:0},K={key:0},Q={class:"category-title"},Y={key:0},Z={key:1},ee={key:2},se={key:3},ne={key:4},te={key:5},oe=["innerHTML"],re={key:1,class:"category-section"},le=["innerHTML"],ae={key:2,class:"category-section"},ie={key:1,class:"timeline-container"},ce={key:0},ue={key:0},ge={class:"category-title"},de={key:0},he={key:1},pe={key:2},_e={key:3},ye={key:4},ve={key:5},fe=["innerHTML"],ke={key:1,class:"category-section"},me=["innerHTML"],Ce={key:2,class:"category-section"},Ee={key:2,class:"no-entries"},Te=R({__name:"ChangelogPage",setup(u){const i=w(),{changelogs:l,isLoading:a,error:g,source:c}=H(i);F(()=>{l.value.length===0&&!a.value&&!g.value&&i.fetchChangelogs()});const _=[{action:"manage",resourceType:"all"}],k=y=>{let n="",t=!1;try{t=x(_),L.addHook("afterSanitizeElements",o=>{var d;if(o instanceof Element&&!t&&o.tagName==="A"&&!o.classList.contains("link-view")){const E=document.createTextNode(o.textContent||"");(d=o.parentNode)==null||d.replaceChild(E,o)}}),n=L.sanitize(y,{USE_PROFILES:{html:!0}})}catch(o){console.error("Error during HTML sanitization or permission check:",o),n=y}finally{L.removeHook("afterSanitizeElements")}return n},m=A(()=>l.value.filter(y=>!y.upcomingRelease)),U=A(()=>l.value.filter(y=>(y.upcomingRelease&&y.isVisibleWhenUpcoming===!0)??!1)),{currentVersion:N}=B(m);return(y,n)=>(s(),e("div",G,[r("h1",null,[n[1]||(n[1]=T(" Changelog ")),h(c)?(s(),e("span",j,p(h(c)),1)):C("",!0),h(N)!=="N/A"?(s(),e("span",X,"Current Version: "+p(h(N)),1)):C("",!0)]),h(a)?(s(),e("p",W,"Loading changelogs...")):h(g)?(s(),e("div",D,[r("p",null,p(h(g)),1),r("button",{onClick:n[0]||(n[0]=(...t)=>h(i).fetchChangelogs&&h(i).fetchChangelogs(...t))},"Retry Fetch")])):(s(),e("div",$,[U.value.length>0?(s(),e("div",q,[n[7]||(n[7]=r("h2",null,"Upcoming Releases",-1)),(s(!0),e(v,null,f(U.value,t=>(s(),e("div",{key:t.version+"-draft",class:"release-card draft-card"},[r("h2",null,[T(p(t.version)+" ",1),n[2]||(n[2]=r("span",{class:"draft-badge"},"(Upcoming)",-1)),t.date?(s(),e("span",J," - "+p(t.date),1)):C("",!0)]),typeof t.changes=="object"&&!Array.isArray(t.changes)&&t.changes!==null?(s(),e("div",K,[(s(!0),e(v,null,f(Object.entries(t.changes),([o,d],E)=>(s(),e("div",{key:E,class:"category-section"},[r("h3",Q,[o.toUpperCase()==="FEATURES"?(s(),e("span",Y,"✨")):o.toUpperCase()==="BUG FIXES"?(s(),e("span",Z,"🐛")):o.toUpperCase()==="IMPROVEMENTS"?(s(),e("span",ee,"🚀")):o.toUpperCase()==="REFACTORING"?(s(),e("span",se,"🔧")):o.toUpperCase()==="TESTS"?(s(),e("span",ne,"🧪")):(s(),e("span",te,"📄")),T(" "+p(o),1)]),r("ul",null,[(s(!0),e(v,null,f(d,(V,b)=>(s(),e("li",{key:b,innerHTML:k(V)},null,8,oe))),128))]),n[3]||(n[3]=r("br",null,null,-1))]))),128))])):Array.isArray(t.changes)?(s(),e("div",re,[n[4]||(n[4]=r("h3",{class:"category-title"},"📄 Changes",-1)),r("ul",null,[(s(!0),e(v,null,f(t.changes,(o,d)=>(s(),e("li",{key:d,innerHTML:k(o)},null,8,le))),128))]),n[5]||(n[5]=r("br",null,null,-1))])):(s(),e("div",ae,n[6]||(n[6]=[r("p",null,"No changes listed for this release.",-1)])))]))),128))])):C("",!0),m.value.length>0?(s(),e("div",ie,[(s(!0),e(v,null,f(m.value,t=>(s(),e("div",{key:t.version,class:P(["release-card",{"current-version":t.version===h(N)}])},[r("h2",null,[T(p(t.version)+" ",1),t.date?(s(),e("span",ce,"- "+p(t.date),1)):C("",!0)]),typeof t.changes=="object"&&!Array.isArray(t.changes)&&t.changes!==null?(s(),e("div",ue,[(s(!0),e(v,null,f(Object.entries(t.changes),([o,d],E)=>(s(),e("div",{key:E,class:"category-section"},[r("h3",ge,[o.toUpperCase()==="FEATURES"?(s(),e("span",de,"✨")):o.toUpperCase()==="BUG FIXES"?(s(),e("span",he,"🐛")):o.toUpperCase()==="IMPROVEMENTS"?(s(),e("span",pe,"🚀")):o.toUpperCase()==="REFACTORING"?(s(),e("span",_e,"🔧")):o.toUpperCase()==="TESTS"?(s(),e("span",ye,"🧪")):(s(),e("span",ve,"📄")),T(" "+p(o),1)]),r("ul",null,[(s(!0),e(v,null,f(d,(V,b)=>(s(),e("li",{key:b,innerHTML:k(V)},null,8,fe))),128))]),n[8]||(n[8]=r("br",null,null,-1))]))),128))])):Array.isArray(t.changes)?(s(),e("div",ke,[n[9]||(n[9]=r("h3",{class:"category-title"},"📄 Changes",-1)),r("ul",null,[(s(!0),e(v,null,f(t.changes,(o,d)=>(s(),e("li",{key:d,innerHTML:k(o)},null,8,me))),128))]),n[10]||(n[10]=r("br",null,null,-1))])):(s(),e("div",Ce,n[11]||(n[11]=[r("p",null,"No changes listed for this release.",-1)])))],2))),128))])):C("",!0),m.value.length===0&&U.value.length===0?(s(),e("p",Ee,"No changelog entries found.")):C("",!0)]))]))}}),Ve=I(Te,[["__scopeId","data-v-9862ee18"]]);export{Ve as default};
