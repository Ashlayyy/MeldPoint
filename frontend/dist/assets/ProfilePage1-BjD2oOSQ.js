import{_ as ne}from"./BaseBreadcrumb.vue_vue_type_style_index_0_lang-BOmi3NWL.js";import{g as q,a1 as G,T as Q,cG as re,W as d,c as x,o as v,w as t,a as e,b as E,ba as T,Z as j,y as N,d as i,t as a,u as s,a0 as W,aS as A,N as D,O as C,P as M,E as U,G as ue,e as g,s as te,V as $,_ as K,br as le,bq as de,bs as ce,aR as B,n as fe,a4 as z,bQ as O,bJ as ve,f as J,cH as I,cI as me,a3 as ae,a9 as _e,X as se,b1 as ge,bE as X,cm as Y,am as Z,J as ee,cJ as ye,bu as be,aK as oe,aL as H,aO as ie,aP as F,a2 as pe,S as he,aQ as Ve,bT as we,cK as ke,cL as xe,cM as Ie,cN as Se,aB as Te,a5 as De}from"./index-5wn-0GR-.js";const Pe={class:"v-avatar"},Ee={class:"text-subtitle-1 mt-1"},Ae={class:"text-subtitle-2 text-disabled font-weight-medium"},Ce=q({__name:"ProfileTab",setup(k){const l=G(),c=Q([{text:"Email",icon:re,divider:!0,subtext:l.user.Email}]),f=d(l.user.Name.split(" ")[0][0]+l.user.Name.split(" ")[1][0]),n=Q([{title:"Full Name",subtext:l.user.Name},{title:"Email",subtext:l.user.Email}]);return(r,o)=>(v(),x($,null,{default:t(()=>[e(E,{cols:"12",lg:"4"},{default:t(()=>[e(T,{variant:"flat"},{default:t(()=>[e(T,{variant:"outlined"},{default:t(()=>[e(j,{lines:"two"},{default:t(()=>[e(N,null,{prepend:t(()=>[i("div",Pe,a(f.value),1)]),title:t(()=>[i("h5",Ee,a(s(l).user.name),1)]),_:1})]),_:1}),e(W),e(A,null,{default:t(()=>[e(j,null,{default:t(()=>[(v(!0),D(C,null,M(c.value,(y,V)=>(v(),D(C,{key:V},[e(N,{color:"primary",value:y,class:"py-4"},{prepend:t(()=>[(v(),x(te(y.icon),{size:"20","stroke-width":"1.5",class:"mr-2"}))]),append:t(()=>[i("span",Ae,a(y.subtext),1)]),default:t(()=>[e(ue,{class:"text-subtitle-1"},{default:t(()=>[g(a(y.text),1)]),_:2},1024)]),_:2},1032,["value"]),y.divider?(v(),x(W,{key:0})):U("",!0)],64))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(E,{cols:"12",lg:"8"},{default:t(()=>[e(T,{variant:"flat"},{default:t(()=>[e(T,{variant:"outlined"},{default:t(()=>[e(A,null,{default:t(()=>[o[1]||(o[1]=i("h5",{class:"text-subtitle-1 mt-6 pb-4"},"Personal Details",-1)),e(W,{class:"mb-4"}),(v(!0),D(C,null,M(n.value,(y,V)=>(v(),x($,{class:"py-2",key:V},{default:t(()=>[e(E,{md:"3",class:"text-subtitle-1"},{default:t(()=>[g(a(y.title),1)]),_:2},1024),e(E,{md:"1",class:"text-subtitle-1"},{default:t(()=>o[0]||(o[0]=[g(":")])),_:1,__:[0]}),e(E,{md:"8",class:"text-medium-emphasis"},{default:t(()=>[g(a(y.subtext),1)]),_:2},1024)]),_:2},1024))),128))]),_:1,__:[1]})]),_:1})]),_:1})]),_:1})]),_:1}))}}),Le=K(Ce,[["__scopeId","data-v-642fa0b2"]]),Ne=le("notification_settings",()=>{const k=d(!0),l=d(!0),c=d(!1),f=d(!0),n=d(!1),r=async()=>{if(!n.value&&"Notification"in window)try{const b=await Notification.requestPermission();c.value=b==="granted",n.value=!0}catch(b){console.error("Error requesting notification permission:",b),c.value=!1}return c.value};return{enabled:k,toastEnabled:l,systemEnabled:c,sound:f,hasRequestedPermission:n,toggleEnabled:b=>{k.value=b},toggleToast:b=>{l.value=b},toggleSystem:async b=>{if(b&&!n.value){const p=await r();c.value=p;return}c.value=b},toggleSound:b=>{f.value=b},requestSystemPermission:r}},{persist:!0}),Ue=q({__name:"NotificationSettings",setup(k){const l=de.global.t,c=Ne(),f=d(Notification.permission==="granted"),{enabled:n,toastEnabled:r,systemEnabled:o,sound:y,hasRequestedPermission:V}=ce(c),L=async p=>{p&&!V.value&&await b()},b=async()=>{const p=await c.requestSystemPermission();f.value=p};return(p,m)=>(v(),x(T,{variant:"outlined",class:"mb-4"},{default:t(()=>[e(B,{class:"d-flex align-center"},{default:t(()=>[e(s(fe),{size:"20",class:"me-2"}),g(" "+a(s(l)("settings.notifications.title")),1)]),_:1}),e(A,null,{default:t(()=>[e(j,null,{default:t(()=>[e(N,null,{default:t(()=>[e(z,{modelValue:s(n),"onUpdate:modelValue":m[0]||(m[0]=_=>O(n)?n.value=_:null),label:s(l)("settings.notifications.enable_all"),color:"primary","hide-details":""},null,8,["modelValue","label"])]),_:1}),s(n)?(v(),x(N,{key:0},{default:t(()=>[e(z,{modelValue:s(r),"onUpdate:modelValue":m[1]||(m[1]=_=>O(r)?r.value=_:null),label:s(l)("settings.notifications.enable_toast"),color:"primary","hide-details":""},null,8,["modelValue","label"])]),_:1})):U("",!0),s(n)?(v(),x(N,{key:1},{default:t(()=>[e(z,{modelValue:s(o),"onUpdate:modelValue":[m[2]||(m[2]=_=>O(o)?o.value=_:null),L],label:s(l)("settings.notifications.enable_system"),color:"primary","hide-details":""},null,8,["modelValue","label"])]),_:1})):U("",!0),s(n)?(v(),x(N,{key:2},{default:t(()=>[e(z,{modelValue:s(y),"onUpdate:modelValue":m[3]||(m[3]=_=>O(y)?y.value=_:null),label:s(l)("settings.notifications.enable_sound"),color:"primary","hide-details":""},null,8,["modelValue","label"])]),_:1})):U("",!0)]),_:1}),s(o)&&!f.value?(v(),x(ve,{key:0,type:"warning",variant:"tonal",class:"mt-4"},{default:t(()=>[g(a(s(l)("settings.notifications.permission_required"))+" ",1),e(J,{color:"warning",variant:"text",class:"mt-2",onClick:b},{default:t(()=>[g(a(s(l)("settings.notifications.request_permission")),1)]),_:1})]),_:1})):U("",!0)]),_:1})]),_:1}))}}),He=le("loginHistory",()=>{const k=G(),l=d([]),c=d([]),f=d(!1),n=d(0),r=d(1),o=d(10);async function y(p,m=!1){var _;if((_=k.user)!=null&&_.id){f.value=!0;try{const P=await I.getLoginHistory({page:p||r.value,limit:o.value});l.value=P.data.data.map(w=>({id:w.id,userId:k.userId,deviceId:w.deviceId,browser:w.deviceInfo.browser,os:w.deviceInfo.os,ipAddress:w.ipAddress,status:w.status,createdAt:new Date(w.createdAt),deviceInfo:w.deviceInfo,currentDeviceInfo:w.currentDeviceInfo})),n.value=P.data.total,r.value=p||r.value}catch(P){throw console.error("Failed to fetch login history:",P),P}finally{f.value=!1}}}async function V(p=!1){var m;if((m=k.user)!=null&&m.id){f.value=!0;try{I.connect();const _=await I.getActiveDevices();c.value=_}catch(_){throw console.error("Failed to fetch active devices:",_),_}finally{f.value=!1}}}async function L(p){var m;if((m=k.user)!=null&&m.id)try{await I.revokeDevice(p),await V(!0)}catch(_){throw console.error("Failed to revoke device:",_),_}}async function b(){var p;if((p=k.user)!=null&&p.id)try{await I.connect(),await new Promise((m,_)=>{if(!I.socket){_(new Error("Socket not connected"));return}I.socket.emit("message",{room:me,type:"revoke-all",data:{}});const P=()=>{m()},w=R=>{_(R)};I.socket.on("security:devices:revoked:all:success",P),I.socket.on("security:error",w),setTimeout(()=>{I.socket&&(I.socket.off("security:devices:revoked:all:success",P),I.socket.off("security:error",w)),_(new Error("Timeout waiting for revoke all devices"))},5e3)}),await V(!0)}catch(m){throw console.error("Failed to revoke all devices:",m),m}}return{loginHistory:l,activeDevices:c,isLoading:f,totalEntries:n,currentPage:r,itemsPerPage:o,fetchLoginHistory:y,fetchActiveDevices:V,revokeDevice:L,revokeAllDevices:b}}),Fe={class:"text-grey"},$e={key:1,class:"text-grey"},qe={class:"d-flex align-center justify-center mt-4"},Be=q({__name:"SecurityTab",setup(k){const{t:l}=ae(),c=G(),f=He(),n=d([]),r=d(!1),o=d(!1),y=d(!1);d(!1);const V=d(1),L=d(10),b=d(0),p=d([]),m=async()=>{try{r.value=!0,await f.fetchActiveDevices(),n.value=f.activeDevices}catch(S){console.error("Failed to fetch devices:",S)}finally{r.value=!1}},_=async S=>{try{await f.revokeDevice(S),await m()}catch(h){console.error("Failed to revoke device:",h)}},P=async()=>{try{await f.revokeAllDevices(),await m()}catch(S){console.error("Failed to revoke all devices:",S)}},w=async()=>{var S;if((S=c.user)!=null&&S.id){o.value=!0;try{await f.fetchLoginHistory(V.value),p.value=f.loginHistory,b.value=f.totalEntries}catch(h){console.error("Failed to fetch login history:",h)}finally{o.value=!1}}},R=S=>{if(!S)return"";try{return new Date(S).toLocaleString(void 0,{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch(h){return console.error("Error formatting date:",h),""}};return _e(V,()=>{w()}),se(async()=>{await m(),await w()}),(S,h)=>(v(),x(ge,null,{default:t(()=>[e($,null,{default:t(()=>[e(E,{cols:"12"},{default:t(()=>[e(T,null,{default:t(()=>[e(B,{class:"d-flex justify-space-between align-center"},{default:t(()=>[i("span",null,a(s(l)("settings.security.devices.title")),1),e(J,{color:"error",variant:"text",disabled:r.value||!n.value.length,onClick:P},{default:t(()=>[g(a(s(l)("settings.security.devices.revoke_all")),1)]),_:1},8,["disabled"])]),_:1}),e(A,null,{default:t(()=>[e(X,null,{default:t(()=>[i("thead",null,[i("tr",null,[i("th",null,a(s(l)("settings.security.devices.device")),1),i("th",null,a(s(l)("settings.security.devices.browser")),1),i("th",null,a(s(l)("settings.security.devices.os")),1),i("th",null,a(s(l)("settings.security.devices.last_active")),1),i("th",null,a(s(l)("settings.security.devices.actions")),1)])]),i("tbody",null,[(v(!0),D(C,null,M(n.value,u=>(v(),D("tr",{key:u.deviceId},[i("td",null,a(u.deviceName),1),i("td",null,a(u.browser),1),i("td",null,a(u.os),1),i("td",null,a(R(u.lastActive)),1),i("td",null,[e(J,{color:"error",variant:"text",disabled:r.value||u.deviceId===s(I).deviceId,onClick:Je=>_(u.deviceId)},{default:t(()=>[g(a(s(l)("settings.security.devices.revoke")),1)]),_:2},1032,["disabled","onClick"])])]))),128))])]),_:1}),e(Y,{modelValue:r.value,"onUpdate:modelValue":h[0]||(h[0]=u=>r.value=u),class:"align-center justify-center"},{default:t(()=>[e(Z,{indeterminate:""})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e($,null,{default:t(()=>[e(E,{cols:"12"},{default:t(()=>[e(T,null,{default:t(()=>[e(B,null,{default:t(()=>[g(a(s(l)("settings.security.login_history.title")),1)]),_:1}),e(A,null,{default:t(()=>[e(X,null,{default:t(()=>[i("thead",null,[i("tr",null,[i("th",null,a(s(l)("settings.security.login_history.date")),1),i("th",null,a(s(l)("settings.security.login_history.browser")),1),i("th",null,a(s(l)("settings.security.login_history.device")),1),i("th",null,a(s(l)("settings.security.login_history.ip")),1),i("th",null,a(s(l)("settings.security.login_history.status")),1)])]),i("tbody",null,[(v(!0),D(C,null,M(p.value,u=>(v(),D("tr",{key:u.id},[i("td",null,a(R(u.createdAt)),1),i("td",null,a(u.deviceInfo.browser)+" ("+a(u.deviceInfo.os)+")",1),i("td",null,[u.currentDeviceInfo?(v(),D(C,{key:0},[g(a(u.currentDeviceInfo.deviceName),1),h[5]||(h[5]=i("br",null,null,-1)),i("small",Fe,[g(a(u.currentDeviceInfo.browser)+" ("+a(u.currentDeviceInfo.os)+") ",1),u.currentDeviceInfo.currentlyActive?(v(),x(ee,{key:0,color:"success",size:"x-small",class:"ml-2"},{default:t(()=>h[4]||(h[4]=[g("Active")])),_:1,__:[4]})):U("",!0)])],64)):(v(),D("span",$e,"Device no longer exists"))]),i("td",null,a(u.ipAddress),1),i("td",null,[e(ee,{color:u.status==="success"?"success":"error",size:"small",variant:"flat"},{default:t(()=>[g(a(u.status),1)]),_:2},1032,["color"])])]))),128))])]),_:1}),i("div",qe,[e(ye,{modelValue:V.value,"onUpdate:modelValue":h[1]||(h[1]=u=>V.value=u),length:Math.ceil(b.value/L.value),"total-visible":7},null,8,["modelValue","length"])]),e(Y,{modelValue:o.value,"onUpdate:modelValue":h[2]||(h[2]=u=>o.value=u),class:"align-center justify-center"},{default:t(()=>[e(Z,{color:"primary",indeterminate:"",size:"64"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(be,{modelValue:y.value,"onUpdate:modelValue":h[3]||(h[3]=u=>y.value=u),"max-width":"500"},{default:t(()=>[e(T,null,{default:t(()=>[e(B,null,{default:t(()=>[g(a(s(l)("settings.security.two_factor.setup_title")),1)]),_:1}),e(A)]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),Me=K(Be,[["__scopeId","data-v-54ab26ee"]]),Re=q({__name:"SettingsTab",setup(k){const{t:l}=ae(),c=d("notifications");return(f,n)=>(v(),x($,null,{default:t(()=>[e(E,{cols:"12"},{default:t(()=>[e(T,{variant:"flat"},{default:t(()=>[e(oe,{modelValue:c.value,"onUpdate:modelValue":n[0]||(n[0]=r=>c.value=r)},{default:t(()=>[e(H,{value:"notifications"},{default:t(()=>[g(a(s(l)("settings.notifications.title")),1)]),_:1}),e(H,{value:"security"},{default:t(()=>[g(a(s(l)("settings.security.title")),1)]),_:1}),e(H,{value:"email"},{default:t(()=>[g(a(s(l)("settings.email.title")),1)]),_:1})]),_:1},8,["modelValue"]),e(A,null,{default:t(()=>[e(ie,{modelValue:c.value,"onUpdate:modelValue":n[1]||(n[1]=r=>c.value=r)},{default:t(()=>[e(F,{value:"notifications"},{default:t(()=>[e(Ue)]),_:1}),e(F,{value:"security"},{default:t(()=>[e(Me)]),_:1}),e(F,{value:"email"},{default:t(()=>n[2]||(n[2]=[i("h3",null,"Coming Soon",-1)])),_:1,__:[2]})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}))}}),ze=q({__name:"ThemeTab",setup(k){const l=pe();se(()=>{l.initializeTheme()});const c=he({get:()=>l.theme,set:n=>{l.setTheme(n),l.applyTheme()}}),f=[{name:"light",icon:ke,label:"Light Mode"},{name:"dark",icon:xe,label:"Dark Mode"},{name:"system",icon:Ie,label:"System"}];return(n,r)=>(v(),x(T,{flat:""},{default:t(()=>[e(Ve,{class:"py-5"},{default:t(()=>[e(B,{class:"text-subtitle-1 font-weight-medium mb-4"},{default:t(()=>r[1]||(r[1]=[g("Theme Mode (WIP. BETA)")])),_:1,__:[1]}),e(A,{class:"pa-0"},{default:t(()=>[e(we,{modelValue:c.value,"onUpdate:modelValue":r[0]||(r[0]=o=>c.value=o),mandatory:"",class:"d-flex flex-wrap gap-2",color:"primary"},{default:t(()=>[(v(),D(C,null,M(f,o=>e(J,{key:o.name,value:o.name,variant:"outlined",class:"px-4"},{default:t(()=>[(v(),x(te(o.icon),{class:"mr-2",size:"20"})),g(" "+a(o.label),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}))}}),Oe=K(ze,[["__scopeId","data-v-b197ae8a"]]),We={class:"pt-6"},Ke=q({__name:"ProfilePage1",setup(k){const l=d({title:"Profile"}),c=d(!1),f=d([{title:"Users",disabled:!0,href:"#"},{title:"Account",disabled:!0,href:"#"},{title:"Profile",disabled:!0,href:"#"}]),n=d("tab-profile");return(r,o)=>(v(),D(C,null,[e(ne,{title:l.value.title,breadcrumbs:f.value},null,8,["title","breadcrumbs"]),e($,null,{default:t(()=>[e(E,{cols:"12"},{default:t(()=>[e(T,{variant:"flat"},{default:t(()=>[e(T,{variant:"outlined"},{default:t(()=>[e(A,null,{default:t(()=>[e(oe,{modelValue:n.value,"onUpdate:modelValue":o[0]||(o[0]=y=>n.value=y),color:"primary"},{default:t(()=>[e(H,{variant:"plain",value:"tab-profile"},{default:t(()=>[e(s(Se),{class:"v-icon--start",width:"20","stroke-width":"1.5"}),o[2]||(o[2]=g(" Profile"))]),_:1,__:[2]}),e(H,{variant:"plain",value:"tab-theme"},{default:t(()=>[e(s(Te),{class:"v-icon--start",width:"20","stroke-width":"1.5"}),o[3]||(o[3]=g(" Thema"))]),_:1,__:[3]}),e(H,{variant:"plain",value:"tab-setting",disabled:!c.value},{default:t(()=>[e(s(De),{class:"v-icon--start",width:"20","stroke-width":"1.5"}),o[4]||(o[4]=g("Settings"))]),_:1,__:[4]},8,["disabled"])]),_:1},8,["modelValue"]),e(W),i("div",We,[e(ie,{modelValue:n.value,"onUpdate:modelValue":o[1]||(o[1]=y=>n.value=y)},{default:t(()=>[e(F,{value:"tab-profile"},{default:t(()=>[e(Le)]),_:1}),e(F,{value:"tab-theme"},{default:t(()=>[e(Oe)]),_:1}),e(F,{value:"tab-setting"},{default:t(()=>[e(Re)]),_:1})]),_:1},8,["modelValue"])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})],64))}});export{Ke as default};
