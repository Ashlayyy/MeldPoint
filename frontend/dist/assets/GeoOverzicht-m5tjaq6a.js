import{u as B}from"./project_store-yqnzPO6Z.js";import{L as c,m as S,a as C,b as I,i as O,v as R}from"./marker-shadow-MpZ-u67R.js";import{g as h,W as i,a9 as A,X as M,aa as T,c as g,w as t,b1 as G,o as p,a,E as y,am as F,cm as J,bJ as W,b as X,d as V,u as z,V as Z,ba as q,aR as H,t as m,ae as U,f as $,aS as K,N as Q,Z as Y,y as j,G as k,e as l,I as b,an as w,a0 as ee,bv as te,bu as ae,_ as oe}from"./index-5wn-0GR-.js";const re={class:"map-container"},le={class:"text-h5"},ne={key:0,class:"mt-4"},se=h({__name:"GeoOverzicht",setup(ie){const v=B(),_=i(null);i(null);const x=i(!0),D=i(null),L=i([52.1326,5.2913]),N=i(7),f=i(!1),n=i(null);delete c.Icon.Default.prototype._getIconUrl,c.Icon.Default.mergeOptions({iconRetinaUrl:I,iconUrl:C,shadowUrl:S});const E=c.icon({iconUrl:C,iconRetinaUrl:I,shadowUrl:S,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),P=()=>{var e;const r=(e=_.value)==null?void 0:e.leafletObject;if(r)try{r.eachLayer(o=>{o instanceof c.Marker&&r.removeLayer(o)}),v.projects.forEach(o=>{if(o.ProjectLocatie)try{const s=o.ProjectLocatie.split(",");if(s.length!==2){console.warn(`Invalid coordinates format for project ${o.ProjectNaam}: ${o.ProjectLocatie}`);return}const u=parseFloat(s[0].trim()),d=parseFloat(s[1].trim());if(isNaN(d)||isNaN(u)){console.warn(`Invalid coordinates for project ${o.ProjectNaam}: lat=${d}, lng=${u}`);return}if(d<-90||d>90||u<-180||u>180){console.warn(`Coordinates out of range for project ${o.ProjectNaam}: lat=${d}, lng=${u}`);return}c.marker([d,u],{icon:E}).bindPopup(`<strong>${o.ProjectNaam}</strong>`).on("click",()=>{n.value=o,f.value=!0}).addTo(r)}catch(s){console.warn(`Error processing coordinates for project ${o.ProjectNaam}:`,s)}})}catch(o){console.error("Error setting up markers:",o)}finally{x.value=!1}};return A(()=>v.projects,async r=>{var e;(e=_.value)!=null&&e.leafletObject&&P()},{deep:!0}),M(async()=>{try{v.projects.length===0&&await v.fetchProjects()}catch(r){console.error("Error fetching projects:",r),D.value=r instanceof Error?r.message:"An error occurred loading the map"}}),T(()=>{var e;const r=(e=_.value)==null?void 0:e.leafletObject;r&&r.eachLayer(o=>{o instanceof c.Marker&&r.removeLayer(o)})}),(r,e)=>(p(),g(G,{fluid:"",class:"fill-height pa-0"},{default:t(()=>[a(J,{modelValue:x.value,"onUpdate:modelValue":e[0]||(e[0]=o=>x.value=o),class:"align-center justify-center"},{default:t(()=>[a(F,{indeterminate:"",size:"64"})]),_:1},8,["modelValue"]),D.value?(p(),g(W,{key:0,type:"error",title:"Error",text:D.value,class:"ma-4"},null,8,["text"])):y("",!0),a(Z,{"no-gutters":"",class:"fill-height"},{default:t(()=>[a(X,{cols:"12",class:"fill-height"},{default:t(()=>[V("div",re,[a(z(O),{ref_key:"mapRef",ref:_,zoom:N.value,"onUpdate:zoom":e[1]||(e[1]=o=>N.value=o),center:L.value,"onUpdate:center":e[2]||(e[2]=o=>L.value=o),"max-zoom":18,"use-global-leaflet":!1,options:{zoomControl:!0,attributionControl:!0},onReady:P},{default:t(()=>[a(z(R),{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png","layer-type":"base",name:"OpenStreetMap"})]),_:1},8,["zoom","center"])])]),_:1})]),_:1}),a(ae,{modelValue:f.value,"onUpdate:modelValue":e[5]||(e[5]=o=>f.value=o),"max-width":"600px"},{default:t(()=>[n.value?(p(),g(q,{key:0},{default:t(()=>[a(H,null,{default:t(()=>[V("span",le,m(n.value.ProjectNaam),1),a(U),a($,{icon:"mdi-close",variant:"text",onClick:e[3]||(e[3]=o=>f.value=!1)})]),_:1}),a(K,null,{default:t(()=>[a(Y,null,{default:t(()=>{var o;return[a(j,null,{prepend:t(()=>[a(w,{color:"primary"},{default:t(()=>e[6]||(e[6]=[l("mdi-identifier")])),_:1,__:[6]})]),default:t(()=>[a(k,null,{default:t(()=>e[7]||(e[7]=[l("Project Nummer")])),_:1,__:[7]}),a(b,null,{default:t(()=>[l(m(n.value.NumberID),1)]),_:1})]),_:1}),a(j,null,{prepend:t(()=>[a(w,{color:"primary"},{default:t(()=>e[8]||(e[8]=[l("mdi-map-marker")])),_:1,__:[8]})]),default:t(()=>[a(k,null,{default:t(()=>e[9]||(e[9]=[l("Locatie")])),_:1,__:[9]}),a(b,null,{default:t(()=>[l(m(n.value.ProjectLocatie),1)]),_:1})]),_:1}),a(j,null,{prepend:t(()=>[a(w,{color:"primary"},{default:t(()=>e[10]||(e[10]=[l("mdi-calendar")])),_:1,__:[10]})]),default:t(()=>[a(k,null,{default:t(()=>e[11]||(e[11]=[l("Start Datum")])),_:1,__:[11]}),a(b,null,{default:t(()=>{var s;return[l(m((s=n.value)!=null&&s.StartDate?new Date(n.value.StartDate).toLocaleDateString():"-"),1)]}),_:1})]),_:1}),(o=n.value)!=null&&o.EndDate?(p(),g(j,{key:0},{prepend:t(()=>[a(w,{color:"primary"},{default:t(()=>e[12]||(e[12]=[l("mdi-calendar-end")])),_:1,__:[12]})]),default:t(()=>[a(k,null,{default:t(()=>e[13]||(e[13]=[l("Eind Datum")])),_:1,__:[13]}),a(b,null,{default:t(()=>[l(m(new Date(n.value.EndDate).toLocaleDateString()),1)]),_:1})]),_:1})):y("",!0)]}),_:1}),a(ee,{class:"my-4"}),n.value.Beschrijving?(p(),Q("div",ne,[e[14]||(e[14]=V("div",{class:"text-h6 mb-2"},"Beschrijving",-1)),V("p",null,m(n.value.Beschrijving),1)])):y("",!0)]),_:1}),a(te,null,{default:t(()=>[a(U),a($,{color:"primary",variant:"text",onClick:e[4]||(e[4]=o=>f.value=!1)},{default:t(()=>e[15]||(e[15]=[l("Sluiten")])),_:1,__:[15]})]),_:1})]),_:1})):y("",!0)]),_:1},8,["modelValue"])]),_:1}))}}),fe=oe(se,[["__scopeId","data-v-1ecf66b1"]]);export{fe as default};
