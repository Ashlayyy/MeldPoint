import{g as T,a3 as N,S as i,a9 as P,X as R,c as v,w as s,b1 as S,o as d,a as t,aR as x,d as n,t as l,f as u,u as o,e as p,bK as O,E as b,aS as h,bc as z,ba as f,bE as E,N as m,P as L,O as j,a7 as A,_ as F}from"./index-5wn-0GR-.js";import{u as K,I as X}from"./backup_store-DZOvVjBz.js";import{c as g}from"./createVueComponent-CKxNTOnQ.js";/**
 * @license @tabler/icons-vue v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var q=g("outline","database","IconDatabase",[["path",{d:"M12 6m-8 0a8 3 0 1 0 16 0a8 3 0 1 0 -16 0",key:"svg-0"}],["path",{d:"M4 6v6a8 3 0 0 0 16 0v-6",key:"svg-1"}],["path",{d:"M4 12v6a8 3 0 0 0 16 0v-6",key:"svg-2"}]]);/**
 * @license @tabler/icons-vue v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var G=g("outline","download","IconDownload",[["path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2",key:"svg-0"}],["path",{d:"M7 11l5 5l5 -5",key:"svg-1"}],["path",{d:"M12 4l0 12",key:"svg-2"}]]);/**
 * @license @tabler/icons-vue v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var H=g("outline","trash","IconTrash",[["path",{d:"M4 7l16 0",key:"svg-0"}],["path",{d:"M10 11l0 6",key:"svg-1"}],["path",{d:"M14 11l0 6",key:"svg-2"}],["path",{d:"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12",key:"svg-3"}],["path",{d:"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3",key:"svg-4"}]]);const J={class:"white--text"},Q={class:"d-flex gap-2"},U={key:0},W={colspan:"3",class:"text-center"},Y=T({__name:"BackupRoute",setup(Z){const _=A(),a=K(),{t:y}=N(),w=i(()=>a.loading&&a.currentOperation==="creating"),B=i(()=>a.loading&&a.currentOperation==="downloading"),C=i(()=>a.loading&&a.currentOperation==="deleting"),c=i(()=>a.createProgress);P(()=>a.createProgress,e=>{e.status==="completed"&&setTimeout(()=>{a.createProgress={status:"",progress:0,message:""}},2e3)},{deep:!0}),R(()=>{a.listBackups()});const I=()=>{a.createBackup()},M=e=>{a.downloadBackup(e)},V=async e=>{confirm(y("admin.backup.confirm_delete"))&&await a.deleteBackup(e)},$=e=>{_.push({name:"backup-restore",params:{selectedBackupId:e}})},D=e=>{try{return new Date(e).toLocaleString()}catch{return"Invalid Date"}};return(e,aa)=>(d(),v(S,null,{default:s(()=>[t(f,{class:"mb-4"},{default:s(()=>[t(x,{class:"d-flex align-center justify-space-between"},{default:s(()=>[n("span",null,l(e.$t("admin.backup.title")),1),t(u,{color:"primary",onClick:I,loading:w.value,disabled:o(a).loading},{default:s(()=>[t(o(q),{class:"mr-2"}),p(" "+l(e.$t("admin.backup.create_backup")),1)]),_:1},8,["loading","disabled"])]),_:1}),t(O,{name:"fade"},{default:s(()=>[c.value.status?(d(),v(h,{key:0},{default:s(()=>[t(z,{"model-value":c.value.progress,color:"primary",height:"20",striped:""},{default:s(()=>[n("span",J,l(c.value.message)+" - "+l(c.value.progress)+"%",1)]),_:1},8,["model-value"])]),_:1})):b("",!0)]),_:1})]),_:1}),t(f,null,{default:s(()=>[t(h,null,{default:s(()=>[t(E,null,{default:s(()=>[n("thead",null,[n("tr",null,[n("th",null,l(e.$t("admin.backup.table.backup_name")),1),n("th",null,l(e.$t("admin.backup.table.created_at")),1),n("th",null,l(e.$t("admin.backup.table.actions")),1)])]),n("tbody",null,[(d(!0),m(j,null,L(o(a).backups,r=>(d(),m("tr",{key:r.id},[n("td",null,l(r.fileName),1),n("td",null,l(D(r.createdAt)),1),n("td",Q,[t(u,{color:"primary",variant:"text",size:"small",onClick:k=>M(r.id),loading:B.value,disabled:o(a).loading},{default:s(()=>[t(o(G),{class:"mr-1"}),p(" "+l(e.$t("admin.backup.download")),1)]),_:2},1032,["onClick","loading","disabled"]),t(u,{color:"error",variant:"text",size:"small",onClick:k=>V(r.id),loading:C.value,disabled:o(a).loading},{default:s(()=>[t(o(H),{class:"mr-1"}),p(" "+l(e.$t("admin.backup.delete")),1)]),_:2},1032,["onClick","loading","disabled"]),t(u,{color:"warning",variant:"text",size:"small",onClick:k=>$(r.id),disabled:o(a).loading},{default:s(()=>[t(o(X),{class:"mr-1"}),p(" "+l(e.$t("admin.backup.restore")),1)]),_:2},1032,["onClick","disabled"])])]))),128)),o(a).backups.length?b("",!0):(d(),m("tr",U,[n("td",W,l(e.$t("admin.backup.no_backups")),1)]))])]),_:1})]),_:1})]),_:1})]),_:1}))}}),la=F(Y,[["__scopeId","data-v-9ae35046"]]);export{la as default};
